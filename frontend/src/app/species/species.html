@if (selectedCategory(); as cat) {
  <!-- Second level: species list within a category -->
  <div class="species-page">
    <div class="back-header">
      <button class="back-btn" (click)="goBack()">
        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="19" y1="12" x2="5" y2="12"/>
          <polyline points="12 19 5 12 12 5"/>
        </svg>
        Back
      </button>
      <h1 class="page-title" [style.color]="color(cat)">{{ cat }}</h1>
    </div>

    @if (currentSpecies().length === 0) {
      <div class="empty-state">
        <p>No sightings recorded under {{ cat }} yet.</p>
      </div>
    } @else {
      <div class="species-list">
        @for (sp of currentSpecies(); track sp.name) {
          <div class="species-row">
            <span class="species-dot" [style.background]="color(cat)"></span>
            <span class="species-name">{{ sp.name }}</span>
            <span class="species-count">{{ sp.count }}</span>
          </div>
        }
      </div>
    }
  </div>
} @else {
  <!-- First level: category grid cards -->
  <div class="species-page">
    <h1 class="page-title">Species</h1>
    <div class="category-grid">
      @for (cat of categories; track cat) {
        <button class="category-card" (click)="selectCategory(cat)">
          <div class="card-image-wrap" [style.background]="color(cat) + '22'">
            @if (categoryCovers()[cat]) {
              <img class="card-image" [src]="categoryCovers()[cat]!" [alt]="cat" />
            }
          </div>
          <div class="card-footer">
            <span class="card-name">{{ cat }}</span>
            <span class="card-count">{{ categoryCounts()[cat] }}</span>
          </div>
        </button>
      }
    </div>
  </div>
}
